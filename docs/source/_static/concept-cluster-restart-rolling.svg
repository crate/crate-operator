<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="901px" preserveAspectRatio="none" style="width:1083px;height:901px;" version="1.1" viewBox="0 0 1083 901" width="1083px" zoomAndPan="magnify"><defs><filter height="300%" id="f7ys33pi8t3fx" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="540.5" cy="20" fill="#000000" filter="url(#f7ys33pi8t3fx)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="289" x="396" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="139" x="406" y="71.1387">Get a list of pods from</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="549" y="71.1387">status.pendingPods</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="213" x="434" y="152.3711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="151" x="444" y="173.5098">Get a list of all K8s pods</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="193" x="444" y="187.4785">belonging to a CrateDB cluster</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="467.5" y="235.3086"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="111" x="477.5" y="256.4473">Patch the list into</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="477.5" y="270.416">status.pendingPods</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="502.5,103.9688,578.5,103.9688,590.5,115.9688,578.5,127.9688,502.5,127.9688,490.5,115.9688,502.5,103.9688" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="544.5" y="138.1792">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="502.5" y="119.7769">list is empty?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="590.5" y="113.3745">no</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="540.5,303.2461,552.5,315.2461,540.5,327.2461,528.5,315.2461,540.5,303.2461" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="449.5" y="395.6484"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="459.5" y="416.7871">Clear</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="495.5" y="416.7871">status.pendingPods</text><ellipse cx="540.5" cy="469.1328" fill="#FFFFFF" filter="url(#f7ys33pi8t3fx)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="540.5" cy="469.1328" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="490.5,347.2461,590.5,347.2461,602.5,359.2461,590.5,371.2461,490.5,371.2461,478.5,359.2461,490.5,347.2461" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="544.5" y="381.4565">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="490.5" y="363.0542">list is still empty?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="602.5" y="356.6519">no</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="210" x="435.5" y="522.1328"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="190" x="445.5" y="543.2715">Take the first pod from the list</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="32,576.1016,190,576.1016,202,588.1016,190,600.1016,32,600.1016,20,588.1016,32,576.1016" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="115" y="610.312">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="32" y="591.9097">K8s pod with that ID exists?</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="43" y="631.812"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="53" y="652.9507">Terminate the pod</text><rect fill="#FFC0CB" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="42.5" y="700.7808"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="52.5" y="721.9194">Wait for some time</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="456.625,576.1016,635.625,576.1016,647.625,588.1016,635.625,600.1016,456.625,600.1016,444.625,588.1016,456.625,576.1016" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="550.125" y="610.312">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="179" x="456.625" y="591.9097">K8s pod with that name exists?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="647.625" y="585.5073">no</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="494.125,631.812,598.125,631.812,610.125,643.812,598.125,655.812,494.125,655.812,482.125,643.812,494.125,631.812" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="104" x="494.125" y="647.6201">cluster is healthy?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="462.125" y="641.2178">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="610.125" y="641.2178">no</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="143" x="331.25" y="665.812"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="123" x="341.25" y="686.9507">Delete pod from list</text><polygon fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" points="364.75,734.7808,440.75,734.7808,452.75,746.7808,440.75,758.7808,364.75,758.7808,352.75,746.7808,364.75,734.7808" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="364.75" y="750.5889">list is empty?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="332.75" y="744.1865">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="452.75" y="744.1865">no</text><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="212" y="768.7808"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="32" x="222" y="789.9194">Clear</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="258" y="789.9194">status.pendingPods</text><ellipse cx="303" cy="847.7183" fill="#FFFFFF" filter="url(#f7ys33pi8t3fx)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="303" cy="847.7183" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f7ys33pi8t3fx)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="177" x="414" y="768.7808"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="157" x="424" y="789.9194">Patch the updated list to</text><text fill="#000000" font-family="monospace" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="126" x="424" y="803.8882">status.pendingPods</text><rect fill="#FFC0CB" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="434" y="850.687"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="444" y="871.8257">Wait for some time</text><rect fill="#FFC0CB" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="621" y="665.812"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="631" y="686.9507">Wait for some time</text><path d="M925,741.2144 L925,757.3472 L905,761.3472 L925,765.3472 L925,781.48 A0,0 0 0 0 925,781.48 L1071,781.48 A0,0 0 0 0 1071,781.48 L1071,751.2144 L1061,741.2144 L925,741.2144 A0,0 0 0 0 925,741.2144 " fill="#FBFB77" filter="url(#f7ys33pi8t3fx)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1061,741.2144 L1061,751.2144 L1071,751.2144 L1061,741.2144 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="931" y="758.2813">Pod is missing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="931" y="773.4141">but should be there</text><rect fill="#FFC0CB" filter="url(#f7ys33pi8t3fx)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="768" y="744.3628"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="778" y="765.5015">Wait for some time</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="30" y2="50"/><polygon fill="#A80036" points="536.5,40,540.5,50,544.5,40,540.5,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="200.3086" y2="235.3086"/><polygon fill="#A80036" points="536.5,225.3086,540.5,235.3086,544.5,225.3086,540.5,229.3086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="127.9688" y2="152.3711"/><polygon fill="#A80036" points="536.5,142.3711,540.5,152.3711,544.5,142.3711,540.5,146.3711" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="590.5" x2="657" y1="115.9688" y2="115.9688"/><polygon fill="#A80036" points="653,207.8086,657,217.8086,661,207.8086,657,211.8086" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="657" x2="657" y1="115.9688" y2="315.2461"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="657" x2="552.5" y1="315.2461" y2="315.2461"/><polygon fill="#A80036" points="562.5,311.2461,552.5,315.2461,562.5,319.2461,558.5,315.2461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="283.2461" y2="303.2461"/><polygon fill="#A80036" points="536.5,293.2461,540.5,303.2461,544.5,293.2461,540.5,297.2461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="83.9688" y2="103.9688"/><polygon fill="#A80036" points="536.5,93.9688,540.5,103.9688,544.5,93.9688,540.5,97.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="429.6172" y2="458.1328"/><polygon fill="#A80036" points="536.5,448.1328,540.5,458.1328,544.5,448.1328,540.5,452.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="371.2461" y2="395.6484"/><polygon fill="#A80036" points="536.5,385.6484,540.5,395.6484,544.5,385.6484,540.5,389.6484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="602.5" x2="641.5" y1="359.2461" y2="359.2461"/><polygon fill="#A80036" points="637.5,428.1328,641.5,438.1328,645.5,428.1328,641.5,432.1328" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="641.5" x2="641.5" y1="359.2461" y2="502.1328"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="641.5" x2="540.5" y1="502.1328" y2="502.1328"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="502.1328" y2="522.1328"/><polygon fill="#A80036" points="536.5,512.1328,540.5,522.1328,544.5,512.1328,540.5,516.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="327.2461" y2="347.2461"/><polygon fill="#A80036" points="536.5,337.2461,540.5,347.2461,544.5,337.2461,540.5,341.2461" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="111" x2="111" y1="665.7808" y2="700.7808"/><polygon fill="#A80036" points="107,690.7808,111,700.7808,115,690.7808,111,694.7808" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="303" y1="802.7495" y2="836.7183"/><polygon fill="#A80036" points="299,826.7183,303,836.7183,307,826.7183,303,830.7183" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="502.5" x2="502.5" y1="816.7183" y2="850.687"/><polygon fill="#A80036" points="498.5,840.687,502.5,850.687,506.5,840.687,502.5,844.687" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="352.75" x2="303" y1="746.7808" y2="746.7808"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="303" x2="303" y1="746.7808" y2="768.7808"/><polygon fill="#A80036" points="299,758.7808,303,768.7808,307,758.7808,303,762.7808" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="452.75" x2="502.5" y1="746.7808" y2="746.7808"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="502.5" x2="502.5" y1="746.7808" y2="768.7808"/><polygon fill="#A80036" points="498.5,758.7808,502.5,768.7808,506.5,758.7808,502.5,762.7808" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="402.75" x2="402.75" y1="699.7808" y2="734.7808"/><polygon fill="#A80036" points="398.75,724.7808,402.75,734.7808,406.75,724.7808,402.75,728.7808" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="482.125" x2="402.75" y1="643.812" y2="643.812"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="402.75" x2="402.75" y1="643.812" y2="665.812"/><polygon fill="#A80036" points="398.75,655.812,402.75,665.812,406.75,655.812,402.75,659.812" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="610.125" x2="689.5" y1="643.812" y2="643.812"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="689.5" x2="689.5" y1="643.812" y2="665.812"/><polygon fill="#A80036" points="685.5,655.812,689.5,665.812,693.5,655.812,689.5,659.812" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="111" x2="111" y1="600.1016" y2="631.812"/><polygon fill="#A80036" points="107,621.812,111,631.812,115,621.812,111,625.812" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="546.125" x2="546.125" y1="600.1016" y2="631.812"/><polygon fill="#A80036" points="542.125,621.812,546.125,631.812,550.125,621.812,546.125,625.812" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="202" x2="444.625" y1="588.1016" y2="588.1016"/><polygon fill="#A80036" points="434.625,584.1016,444.625,588.1016,434.625,592.1016,438.625,588.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="540.5" y1="556.1016" y2="561.1016"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="540.5" x2="111" y1="561.1016" y2="561.1016"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="111" x2="111" y1="561.1016" y2="576.1016"/><polygon fill="#A80036" points="107,566.1016,111,576.1016,115,566.1016,111,570.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="647.625" x2="836.5" y1="588.1016" y2="588.1016"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="836.5" x2="836.5" y1="588.1016" y2="744.3628"/><polygon fill="#A80036" points="832.5,734.3628,836.5,744.3628,840.5,734.3628,836.5,738.3628" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[f0dd360891b4458833c07783a4651f8f]
@startuml concept-cluster-restart-rolling

start

:Get a list of pods from ""status.pendingPods"";

if (list is empty?) then (yes)
    :Get a list of all K8s pods
    belonging to a CrateDB cluster;

    :Patch the list into
    ""status.pendingPods"";
else (no)
endif

if (list is still empty?) then (yes)
    :Clear ""status.pendingPods"";

    stop
else (no)
endif

:Take the first pod from the list;

if (K8s pod with that ID exists?) then (yes)
    :Terminate the pod;
    #pink:Wait for some time;
    kill
elseif (K8s pod with that name exists?) then (yes)
    if (cluster is healthy?) then (yes)
        :Delete pod from list;

        if (list is empty?) then (yes)
            :Clear ""status.pendingPods"";

            stop
        else (no)
            :Patch the updated list to
            ""status.pendingPods"";

            #pink:Wait for some time;
            kill
        endif
    else (no)
        #pink:Wait for some time;
        kill
    endif
else (no)
    #pink:Wait for some time;
    note right: Pod is missing\nbut should be there
    kill
endif

@enduml

PlantUML version 1.2020.19(Mon Oct 12 17:10:01 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>